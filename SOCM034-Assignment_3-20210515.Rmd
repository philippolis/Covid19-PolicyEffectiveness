---
title: "SOCM034-Assignment_3"
author: "Philipp Holz"
date: "15 May 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE)

library(dplyr)
library(tidyr) # for fill function used to fill missing values for Google trends data
library(gtrendsR) # for retreiving Google trends data
library(scales) # for rescaling function used to rescale compliance index
library(astsa) # for tsplot
library(xts) # for time series things
library(ggplot2) # you know it <3
library(egg) # for arranging multiple plots

setwd("C:/Users/holzp/OneDrive/02 Ausbildung/06 Studium Master/Exeter/Classes/SOCM034 - Data Science and Policy Analytics/23 Assessment 3")
```

First step: Getting the data ready.
```{r data, eval=TRUE, include=FALSE}
## Adding the Policy Data -----
### Read in the Data
policy_data <- read.csv("PolicyData.csv")

### convert Date column to date format
policy_data$Date = as.Date(as.character(policy_data$Date), format = "%Y%m%d")

### create dataframe with only national level data
policy_data <- policy_data %>% filter(Jurisdiction == "NAT_TOTAL")

### create dataframe with only national level of selected countries
policy_data <- policy_data %>% filter(CountryCode == "DEU" |
                                       CountryCode == "ITA" |
                                       CountryCode == "FRA" |
                                       CountryCode == "GBR")

### Only selecting the columns that are interesting
policy_data <- policy_data %>% select(Date, CountryName, StringencyIndex)


## Adding the Mobility Data ----
### Reading in the data
mobility_data <- read.csv("MobilityData.csv")

### Create mobility data frame for Europe
mobility_data <- mobility_data %>% filter((country_region == "Germany" |
                                           country_region == "Italy" |
                                           country_region == "France" |
                                           country_region == "United Kingdom") &
                                           sub_region_1 == "")

### Add a column with an average of the change in sectors, excluding parks
mobility_data <- mobility_data %>% mutate(avg_change = rowMeans(.[,c(10, 11, 13, 14, 15)]))

### force recognition of the date format
mobility_data$date = as.Date(mobility_data$date, format = "%Y-%m-%d")

### renaming the date columns to match
names(mobility_data)[names(mobility_data)=="date"] <- "Date"
names(mobility_data)[names(mobility_data)=="country_region"] <- "CountryName"
names(mobility_data)[names(mobility_data)=="avg_change"] <- "MobilityIndex"

### Only selecting relevant data
mobility_data <- mobility_data %>% select(Date, CountryName, MobilityIndex)


## Adding the Cases Data ----

###read the Dataset sheet in
cases_data <- read.csv("CasesData.csv")

cases_data <- cases_data %>% filter(location == "Germany" |
                                    location == "Italy" |
                                    location == "France" |
                                    location == "United Kingdom") %>%
                             select(location, date, reproduction_rate) %>%
                             rename(CountryName = location, 
                                    Date = date,
                                    ReproductionRate = reproduction_rate)

### Forcing Date format
cases_data$Date = as.Date(as.character(cases_data$Date), format = "%Y-%m-%d")

## Adding the Trends Data ----
trends_germany <- gtrends(keyword = c("corona"),
                    geo = "DE",
                    time = "2020-01-01 2021-05-14",
                    onlyInterest = TRUE)$interest_over_time[,c("date", "hits", "geo")]

trends_uk <- gtrends(keyword = c("covid"),
                    geo = "GB",
                    time = "2020-01-01 2021-05-14",
                    onlyInterest = TRUE)$interest_over_time[,c("date", "hits", "geo")]

trends_france <- gtrends(keyword = c("covid"),
                    geo = "FR",
                    time = "2020-01-01 2021-05-14",
                    onlyInterest = TRUE)$interest_over_time[,c("date", "hits", "geo")]

trends_italy <- gtrends(keyword = c("covid"),
                    geo = "IT",
                    time = "2020-01-01 2021-05-14",
                    onlyInterest = TRUE)$interest_over_time[,c("date", "hits", "geo")]

trends_data <- rbind(trends_germany, trends_uk, trends_france, trends_italy)

trends_data <- trends_data %>% rename(Date = date,
                                      PublicityIndex = hits,
                                      CountryName = geo)

trends_data$CountryName[trends_data$CountryName == "DE"] <- "Germany"
trends_data$CountryName[trends_data$CountryName == "GB"] <- "United Kingdom"
trends_data$CountryName[trends_data$CountryName == "FR"] <- "France"
trends_data$CountryName[trends_data$CountryName == "IT"] <- "Italy"

### Forcing correct date format
trends_data$Date = as.Date(trends_data$Date, format = "%Y-%m-%d")

### Forcing numeric format for publicity
trends_data$PublicityIndex <- as.numeric(trends_data$PublicityIndex)

## Merging policy mobility trends and cases data on date and country ----

data = policy_data %>% 
  full_join(mobility_data, by = c("Date", "CountryName")) %>%
  full_join(cases_data, by = c("Date", "CountryName")) %>%
  full_join(trends_data, by = c("Date", "CountryName"))

### Removing unwanted objects
rm(cases_data, mobility_data, policy_data, trends_data, trends_france, 
   trends_germany, trends_italy, trends_uk)

### Filling missing values with previous value
data <- data %>% fill(PublicityIndex)

## Adding a column with Compliance-index ----
data$ComplianceIndex <- 100 - (data$StringencyIndex + data$MobilityIndex)

### Rescaling the Compliance-index to assume values between 0 and 100
data$ComplianceIndex <- rescale(data$ComplianceIndex, to = c(0, 100))

```

# Introduction

Research questions: 

A: *In which countries were the measures the most effective in lowering the reproduction rate?*

B: *In which countries were the measures the most efficient in lowering the reproduction rate? Efficient in the sense of effective, while being less intrusive, so, when correcting the relationship for reductions in mobility.*

# Modeling strategy

To address the research questions we run two models. 

The first question (In which countries were the measures the most effective in lowering the reproduction rate?) will be addressed by a model with reproduction rate as the outcome variable and policy stringency as the predictor variable. 

The second question (In which countries were the measure the most efficient?) will be addressed by the same model, which additionally corrects for the mobility index.

First, explore the time series data to remove potential outliers.
```{r}
Repro_plot <- ggplot(aes(x = Date, y = ReproductionRate, color = CountryName), data = data) +
  geom_smooth(se = FALSE, span = 0.1, size = 0.5) +
  facet_wrap(~ CountryName, nrow = 1) +
  ylab("Reproduction Rate") +
  xlab("") +
  scale_x_date(date_breaks = "3 months", 
                 labels=date_format("%b %Y"),
                 limits = as.Date(c('2020-01-01','2021-05-15'))) +
  theme(legend.position = "none",
        axis.text.x = element_blank())

Stringency_plot <- ggplot(aes(x = Date, y = StringencyIndex, color = CountryName), data = data) +
  geom_line() +
  facet_wrap(~ CountryName, nrow = 1) +
  ylab("Stringency Index") +
  xlab("") +
  scale_x_date(date_breaks = "3 months", 
                 labels=date_format("%b %Y"),
                 limits = as.Date(c('2020-01-01','2021-05-15'))) +
  theme(legend.position = "none",
        axis.text.x = element_blank(),
        strip.background = element_blank(),
        strip.text.x = element_blank())

Mobility_plot <- ggplot(aes(x = Date, y = MobilityIndex, color = CountryName), data = data) +
  geom_smooth(se = FALSE, span = 0.1, size = 0.5) +
  facet_wrap(~ CountryName, nrow = 1) +
  ylab("Mobility Index") +
  xlab("Date") +
  scale_x_date(date_breaks = "3 months", 
                 labels=date_format("%b %Y"),
                 limits = as.Date(c('2020-01-01','2021-05-15'))) +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 90, vjust = 0.4),
        strip.background = element_blank(),
        strip.text.x = element_blank())

ggarrange(Repro_plot, Stringency_plot, Mobility_plot)
```

As we can see, by far the most extreme values for reproduction rate, stringency index and mobility index are in March 2020. This is the case for all the countries included in our analysis. Thus, by excluding the month March from our analysis, we are likely to receive much better estimations. Let's see what these plots would look like when excluding March 2020 from our time series.

```{r}
Repro_plot <- data %>% filter(Date >= as.Date("2020-04-01")) %>% ggplot(aes(x = Date, y = ReproductionRate, color = CountryName)) +
  geom_smooth(se = FALSE, span = 0.1, size = 0.5) +
  facet_wrap(~ CountryName, nrow = 1) +
  ylab("Reproduction Rate") +
  xlab("") +
  scale_x_date(date_breaks = "3 months", 
                 labels=date_format("%b %Y"),
                 limits = as.Date(c('2020-03-20','2021-05-15'))) +
  theme(legend.position = "none",
        axis.text.x = element_blank())

Stringency_plot <- data %>% filter(Date >= as.Date("2020-04-01")) %>% ggplot(aes(x = Date, y = StringencyIndex, color = CountryName)) +
  geom_line() +
  facet_wrap(~ CountryName, nrow = 1) +
  ylab("Stringency Index") +
  xlab("") +
  scale_x_date(date_breaks = "3 months", 
                 labels=date_format("%b %Y"),
                 limits = as.Date(c('2020-03-20','2021-05-15'))) +
  theme(legend.position = "none",
        axis.text.x = element_blank(),
        strip.background = element_blank(),
        strip.text.x = element_blank())

Mobility_plot <- data %>% filter(Date >= as.Date("2020-04-01")) %>% ggplot(aes(x = Date, y = MobilityIndex, color = CountryName)) +
  geom_smooth(se = FALSE, span = 0.1, size = 0.5) +
  facet_wrap(~ CountryName, nrow = 1) +
  ylab("Mobility Index") +
  xlab("Date") +
  scale_x_date(date_breaks = "3 months", 
                 labels=date_format("%b %Y"),
                 limits = as.Date(c('2020-03-20','2021-05-15'))) +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 90, vjust = 0.4),
        strip.background = element_blank(),
        strip.text.x = element_blank())

ggarrange(Repro_plot, Stringency_plot, Mobility_plot)

```

Values are now much more equally distributed. (Do I need to show you in a histogram?)

In these plots, we have actually used a smoother for the reproduction rate and mobility index, because of seasonality. let's remove the seasonality from these time series. 

First, let's check what the seasonality looks like with United Kingdom as the example, then we remove the seasonality, that is likely a weekly one.

```{r}
UK_data <- data %>% filter(CountryName == "United Kingdom" & Date >= as.Date("2020-04-01"))

# Let's remove the seasonality from the Mobility data in UK
UK_Mobility_ts <- ts(UK_data[,"MobilityIndex"], frequency = 7, start = c(2020, 1))

frequency(UK_Mobility_ts)

UK_data$Mobility_trend <- decompose(UK_Mobility_ts, type = "additive")$trend

# Seasonality successfully removed!
ggplot(data = UK_data) + 
  geom_line(aes(x = Date, y = MobilityIndex), color = "darkgrey") +
  geom_line(aes(x = Date, y = Mobility_trend), color = "red", size = 1)

```


To estimate the models, first off, we will try to achieve stationarity in the respective time series data.

```{r ts_objects}
# Germany ----
Germany_data <- data %>% filter(CountryName == "Germany")

Germany_Stringency_ts <- ts(Germany_data[,"StringencyIndex"], frequency = 365, start = c(2020, 1))

tsplot(Germany_Stringency_ts)

Germany_Compliance_ts <- ts(Germany_data[,"ComplianceIndex"], frequency = 365, start = c(2020, 1))

tsplot(Germany_Compliance_ts)

# Let's remove the seasonality from the Mobility data in Germany
Germany_Mobility_ts <- ts(Germany_data[,"MobilityIndex"], frequency = 7, start = c(2020, 1))

frequency(Germany_Mobility_ts)

Germany_data$Mobility_trend <- decompose(Germany_Mobility_ts, type = "additive")$trend

# Seasonality successfully removed!
ggplot(data = Germany_data) + 
  geom_line(aes(x = Date, y = MobilityIndex), color = "red") +
  geom_line(aes(x = Date, y = Mobility_trend), color = "blue")


# France ----
France_data <- data %>% filter(CountryName == "France")

France_Stringency_ts <- ts(France_data[,"StringencyIndex"], frequency = 365, start = c(2020, 1))

tsplot(France_Stringency_ts)

tsplot(France_data$ComplianceIndex, main = "France")

summary(fit <- lm(ComplianceIndex ~ PublicityIndex + ReproductionRate + Date, data = France_data))

summary(fit <- lm(ReproductionRate ~ StringencyIndex + Date, data = France_data))

summary(fit <- lm(ReproductionRate ~ StringencyIndex + Date + MobilityIndex, data = France_data))

ggplot(data = France_data, aes(x = StringencyIndex, y = MobilityIndex)) +
  geom_point()

ggplot(data = France_data, aes(x = MobilityIndex, y = ReproductionRate)) +
  geom_point()

# Let's try France_data
ggplot(data = France_data) +
  geom_line(aes(x = Date, y = ReproductionRate *33), color = "red") +
  geom_smooth(aes(x = Date, y = MobilityIndex + 100), color = "blue", span = 0.1)

# Test no lag
ggplot(data = France_data, aes(x = MobilityIndex, y = ReproductionRate)) +
  geom_point()

summary(fit <- lm(ReproductionRate ~ StringencyIndex + Date + MobilityIndex, data = France_data))

#StringencyIndex -0.013242   0.001966  -6.735 5.29e-11 ***
#Date            -0.001236   0.000144  -8.587  < 2e-16 ***
#MobilityIndex   -0.000446   0.002155  -0.207    0.836    

# Mobility Index is not significant on the reproduction rate, so let's try introducing a lag

# Test a lag of 7
France_data$ReproductionRate_lag7<-lag(France_data$ReproductionRate, 7)

ggplot(data = France_data, aes(x = MobilityIndex, y = ReproductionRate_lag7)) +
  geom_point()

summary(fit <- lm(ReproductionRate_lag7 ~ StringencyIndex + Date + MobilityIndex, data = France_data))

#StringencyIndex -0.0118180  0.0021652  -5.458 8.22e-08 ***
#Date            -0.0010434  0.0001638  -6.370 4.96e-10 ***
#MobilityIndex   -0.0077215  0.0023881  -3.233  0.00132 **

# Test a lag of 14
France_data$ReproductionRate_lag14<-lag(France_data$ReproductionRate, 14)

ggplot(data = France_data, aes(x = MobilityIndex, y = ReproductionRate_lag14)) +
  geom_point()

summary(fit <- lm(ReproductionRate_lag14 ~ StringencyIndex + Date + MobilityIndex, data = France_data))

#StringencyIndex -0.0098840  0.0021368  -4.625 5.00e-06 ***
#Date            -0.0006785  0.0001680  -4.039 6.40e-05 ***
#MobilityIndex   -0.0168397  0.0023799  -7.076 6.37e-12 ***

# Test a lag of 21
France_data$ReproductionRate_lag21<-lag(France_data$ReproductionRate, 21)

ggplot(data = France_data, aes(x = MobilityIndex, y = ReproductionRate_lag21)) +
  geom_point()

summary(fit <- lm(ReproductionRate_lag21 ~ StringencyIndex + Date + MobilityIndex, data = France_data))

#StringencyIndex -0.0090031  0.0020399  -4.414  1.3e-05 ***
#Date            -0.0005215  0.0001630  -3.200 0.001484 ** 
#MobilityIndex   -0.0213216  0.0022829  -9.340  < 2e-16 ***

# Test a lag of 28
France_data$ReproductionRate_lag28<-lag(France_data$ReproductionRate, 28)

ggplot(data = France_data, aes(x = MobilityIndex, y = ReproductionRate_lag28)) +
  geom_point()

summary(fit <- lm(ReproductionRate_lag28 ~ StringencyIndex + Date + MobilityIndex, data = France_data))

#StringencyIndex -0.0072850  0.0020086  -3.627 0.000324 ***
#Date            -0.0006028  0.0001618  -3.725 0.000224 ***
#MobilityIndex   -0.0222169  0.0022857  -9.720  < 2e-16 ***

# Test a lag of 35
France_data$ReproductionRate_lag35<-lag(France_data$ReproductionRate, 35)

ggplot(data = France_data, aes(x = MobilityIndex, y = ReproductionRate_lag35)) +
  geom_point()

summary(fit <- lm(ReproductionRate_lag35 ~ StringencyIndex + Date + MobilityIndex, data = France_data))

#StringencyIndex -0.0039605  0.0020030  -1.977   0.0487 *  
#Date            -0.0007683  0.0001629  -4.715 3.35e-06 ***
#MobilityIndex   -0.0212771  0.0023290  -9.136  < 2e-16 ***

ggplot(data = France_data) +
  geom_line(aes(x = Date, y = ReproductionRate_lag14 *33), color = "red") +
  geom_smooth(aes(x = Date, y = MobilityIndex + 100), color = "blue", span = 0.1, se = FALSE)

# Let's try Germany_data
ggplot(data = Germany_data) +
  geom_line(aes(x = Date, y = ReproductionRate *33), color = "red") +
  geom_line(aes(x = Date, y = Mobility_trend + 100), color = "blue", span = 0.1)

# Test no lag
## with MobilityIndex
summary(fit <- lm(ReproductionRate ~ StringencyIndex + Date + MobilityIndex, data = Germany_data))

#StringencyIndex -0.0268105  0.0021235 -12.626  < 2e-16 ***
#Date             0.0003189  0.0001667   1.913   0.0564 .  
#MobilityIndex   -0.0090248  0.0020619  -4.377 1.51e-05 ***

## with Mobility Trend
summary(fit <- lm(ReproductionRate ~ StringencyIndex + Date + Mobility_trend, data = Germany_data))

#StringencyIndex -4.104e-02  2.905e-03 -14.125  < 2e-16 ***
#Date             8.281e-04  1.753e-04   4.724 3.14e-06 ***
#Mobility_trend  -2.905e-02  3.536e-03  -8.215 2.52e-15 ***

# Test a lag of 7
## with MobilityIndex
Germany_data$ReproductionRate_lag7<-lag(Germany_data$ReproductionRate, 7)

summary(fit <- lm(ReproductionRate_lag7 ~ StringencyIndex + Date + MobilityIndex, data = Germany_data))

#StringencyIndex -0.0329944  0.0036839  -8.956  < 2e-16 ***
#Date             0.0002349  0.0002076   1.132    0.258    
#Mobility_trend  -0.0318214  0.0042801  -7.435 5.89e-13 ***

## With Mobility Trend
summary(fit <- lm(ReproductionRate_lag7 ~ StringencyIndex + Date + Mobility_trend, data = Germany_data))

#StringencyIndex -0.0165246  0.0026331  -6.276 8.62e-10 ***
#Date            -0.0003198  0.0001945  -1.644   0.1009    
#MobilityIndex   -0.0097571  0.0024258  -4.022 6.83e-05 ***

# Test a lag of 14
## With Mobility Index
Germany_data$ReproductionRate_lag14<-lag(Germany_data$ReproductionRate, 14)

summary(fit <- lm(ReproductionRate_lag14 ~ StringencyIndex + Date + MobilityIndex, data = Germany_data))

#StringencyIndex -0.0031334  0.0028550  -1.098 0.273050    
#Date            -0.0009540  0.0002006  -4.755 2.74e-06 ***
#MobilityIndex   -0.0095326  0.0025214  -3.781 0.000179 ***

## With Mobility trend
summary(fit <- lm(ReproductionRate_lag14 ~ StringencyIndex + Date + Mobility_trend, data = Germany_data))

#StringencyIndex -0.0210894  0.0040563  -5.199 3.15e-07 ***
#Date            -0.0003870  0.0002152  -1.798   0.0729 .  
#Mobility_trend  -0.0326231  0.0045424  -7.182 3.20e-12 ***

# Test a lag of 21
## with Mobility Index
Germany_data$ReproductionRate_lag21<-lag(Germany_data$ReproductionRate, 21)

summary(fit <- lm(ReproductionRate_lag21 ~ StringencyIndex + Date + MobilityIndex, data = Germany_data))

#StringencyIndex  0.0060020  0.0028332   2.118  0.03474 *  
#Date            -0.0013587  0.0001984  -6.848 2.75e-11 ***
#MobilityIndex   -0.0075684  0.0024993  -3.028  0.00262 **

## With Mobility Trend
summary(fit <- lm(ReproductionRate_lag21 ~ StringencyIndex + Date + Mobility_trend, data = Germany_data))

#StringencyIndex -0.0108738  0.0041624  -2.612  0.00932 ** 
#Date            -0.0008679  0.0002134  -4.067 5.71e-05 ***
#Mobility_trend  -0.0289691  0.0046497  -6.230 1.16e-09 ***

# Test a lag of 28
## With MobilityIndex
Germany_data$ReproductionRate_lag28<-lag(Germany_data$ReproductionRate, 28)

summary(fit <- lm(ReproductionRate_lag28 ~ StringencyIndex + Date + MobilityIndex, data = Germany_data))

#StringencyIndex  0.0093389  0.0028369   3.292  0.00108 ** 
#Date            -0.0016089  0.0002047  -7.860 3.56e-14 ***
#MobilityIndex   -0.0065962  0.0025003  -2.638  0.00866 **

## With Mobility_trend
summary(fit <- lm(ReproductionRate_lag28 ~ StringencyIndex + Date + Mobility_trend, data = Germany_data))


# Let's check, how far the changes in the Reproduction rate lag behind after the changes in Stringency
## First we have to check for autocorrelation
acf(diff(Germany_data$StringencyIndex)) # no autocorrelation!

library(broom.mixed)

fct <- function (CountryName) {
      
      country_data <- data %>% 
                        filter(CountryName == CountryName)
      
      lag <- vector()
      pvalue <- vector()
      country <- vector()
    
      for (i in 0:35) {
        lag[i] <- i
        pvalue[i] <- as.numeric(glance(lm(diff(lag(ReproductionRate, i)) ~ diff(StringencyIndex), data = country_data))$p.value)
        country[i] <- CountryName
      }
      
      df <- data.frame(lag, pvalue, country)
      
}

df_France <- fct(CountryName = "France")

df_Germany <- fct(CountryName = "Germany")

df_Italy <- fct(CountryName = "Italy")

df_UK <- fct(CountryName = "United Kingdom")

ggplot() +
  geom_line(data = df_France, aes(x = lag, y = pvalue), color = "red") +
  geom_line(data = df_Germany, aes(x = lag, y = pvalue)) +
  geom_line(data = df_Italy, aes(x = lag, y = pvalue)) +
  geom_line(data = df_UK, aes(x = lag, y = pvalue))
  

summary(lm(diff(lag(ReproductionRate, i)) ~ diff(StringencyIndex), data = Germany_data))$coefficients

ggplot(data = df, aes(x = lag, y = pvalue)) +
  geom_line()

#StringencyIndex -0.0058821  0.0041583  -1.415    0.158    
#Date            -0.0011966  0.0002174  -5.505 6.61e-08 ***
#Mobility_trend  -0.0262694  0.0046969  -5.593 4.14e-08 ***

# Test a lag of 35
## With MobilityIndex
Germany_data$ReproductionRate_lag35<-lag(Germany_data$ReproductionRate, 35)

summary(fit <- lm(ReproductionRate_lag35 ~ StringencyIndex + Date + MobilityIndex, data = Germany_data))

#StringencyIndex  0.0128314  0.0028535   4.497 9.08e-06 ***
#Date            -0.0018904  0.0002129  -8.881  < 2e-16 ***
#MobilityIndex   -0.0054165  0.0024809  -2.183   0.0296 * 

## With Mobility_trend
summary(fit <- lm(ReproductionRate_lag35 ~ StringencyIndex + Date + Mobility_trend, data = Germany_data))

#StringencyIndex  0.0003342  0.0041719   0.080    0.936    
#Date            -0.0015676  0.0002248  -6.974 1.31e-11 ***
#Mobility_trend  -0.0217869  0.0047233  -4.613 5.38e-06 ***

ggplot(data = Germany_data) +
  geom_line(aes(x = Date, y = ReproductionRate_lag21 *33), color = "red") +
  geom_line(aes(x = Date, y = Mobility_trend + 100), color = "blue")


library(ggplot2)
ggplot(data = France_data) +
  geom_line(aes(x = Date, y = MobilityIndex+100), color = "green") +
  geom_line(aes(x = Date, y = ReproductionRate*33), color = "brown") +
  geom_line(aes(x = Date, y = StringencyIndex), color = "blue") +
  geom_line(aes(x = Date, y = PublicityIndex), color = "purple") +
  geom_line(aes(x = Date, y = ComplianceIndex), color = "grey")








as.Date("2020-04-01") < as.Date("2020-04-02")

# UK ----
UK_data <- data %>% filter(CountryName == "United Kingdom")

UK_Stringency_ts <- ts(UK_data[,"StringencyIndex"], frequency = 365, start = c(2020, 1))

tsplot(UK_Stringency_ts)

# Italy ----
Italy_data <- data %>% filter(CountryName == "Italy")

Italy_Stringency_ts <- ts(Italy_data[,"StringencyIndex"], frequency = 365, start = c(2020, 1))

tsplot(Italy_Stringency_ts)

# Conjoint
par(mfrow=c(4,1))
plot(Germany_Stringency_ts)
plot(France_Stringency_ts)
plot(Italy_Stringency_ts)
plot(UK_Stringency_ts)

```


Third step: Making the time series stationary
```{r}

```

# Methods

- there are different ways to obtain mobility data
  - one study used voluntarily tracked mobility data [@vannoniUsingVolunteeredGeographic2020]
  - another study used Twitter-based population mobility data [@zengSpatialTemporalRelationshipPopulation2021]